


<!DOCTYPE html>

<html lang="en">

    <head>
       <script type="text/javascript" src="/assets/jquery.js?body=1"></script>

<script type="text/javascript" src="/assets/bootstrap.js?body=1"></script>


    </head>


<h1>Roadmap</h1>
    <!-- Projektliste -->
<br><br>
<div class="well sidebar-nav">
  <div class="dropdown">
  <button class="btn dropdown-toggle sr-only" type="button" id="dropdownMenu1" data-toggle="dropdown">
    Projekt auswählen ...
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

  <% @projekts.each do |projekte| %>
      <% if projekte.projektleiter == current_user.email %> 
        <li> 
         <li > <%= link_to  projekte.projektname, roadmaps_path(:id=>projekte.id),'data-no-turbolink' => true%></li> 

         <% end %>
         <% end %>
  </ul>
</div>
</div>
<br><br>
<h2>Projektname: <%= @projekt.projektname %></h2>
<br><br>
<div class="well sidebar-nav">
<table class="table table-hover">
<thead>
          <tr>
            <th>Projektteil</th>
            <th>Zuständiger</th>
            <th>Status</th>
            <th>Startdatum</th>
            <th>Zieldatum</th>
          </tr>
 </thead>

 <tbody> 
<tr>

      <% if @projekt.projektleiter == current_user.email %> 
     
            <% @aufgaben.each do |aufgabe| %>
              <% if  @projekt.id == aufgabe.projektsid && aufgabe.aufgabenvorgaenger ==nil %>
                <% @vorgaenger1 = aufgabe.id %>
                <% @nachfolger1 = Aufgaben.find(:all, :conditions => [ "aufgabenvorgaenger = ?", aufgabe.id]) %>
               <tr class="success"> 
                 <td> <%= aufgabe.aufgabenname %></td> 
                 </tr>
                  <% if !@nachfolger1.present? %> <!-- Keine Aufgabe als Nachfolger vorhanden (APs anzeigen)-->
                      <!-- Arbeitspakete für Aufgaben der Ebene 1 -->
                    <tr> 
                      <% @arbeitspakets.each do |arbeitspaket| %>
                        <% if aufgabe.id == arbeitspaket.aufgabeid %>
                        <tr class="error">      
                            <td ><i class="icon-arrow-right" > <%= arbeitspaket.arbeitspaketname %> </td> 
                          </tr>                        
                        <% end %>
                      <% end %>
                
                  <% else %> <!-- Aufgabe als Nachfolger vorhanden -->
                    <!-- Ebene 2 -->
                    
                      <% @aufgaben.each do |aufgabe| %>
                        <% if  @projekt.id == aufgabe.projektsid && aufgabe.aufgabenvorgaenger ==@vorgaenger1 %>
                          <% @vorgaenger2 = aufgabe.id %>
                          <% @nachfolger2 = Aufgaben.find(:all, :conditions => [ "aufgabenvorgaenger = ?", aufgabe.id]) %>
                        <tr class="success"> 
                            <td ><%= aufgabe.aufgabenname %></td> 
                            </tr >
                            <% if !@nachfolger2.present? %> <!-- Keine Aufgabe als Nachfolger vorhanden (APs anzeigen)-->
                            <!-- Arbeitspakete für Aufgaben der Ebene 2 -->
                              
                                <% @arbeitspakets.each do |arbeitspaket| %>
                                  <% if aufgabe.id == arbeitspaket.aufgabeid %>  
                                  <tr class="error">    
                                        <td><i class="icon-arrow-right" > <%= arbeitspaket.arbeitspaketname %> </td> 
                                               </tr>               
                                  <% end %>
                                <% end %>
                            <% else %> <!-- Aufgabe als Nachfolger vorhanden -->

                              <!-- Ebene 3 -->
                              
                                <% @aufgaben.each do |aufgabe| %>
                                  <% if  @projekt.id == aufgabe.projektsid && aufgabe.aufgabenvorgaenger ==@vorgaenger2%>
                                    <% @vorgaenger3 = aufgabe.id %>
                                    <% @nachfolger3 = Aufgaben.find(:all, :conditions => [ "aufgabenvorgaenger = ?", aufgabe.id]) %>
                                    <tr class="success"> 
                                      <td>  <%= aufgabe.aufgabenname %></td>  
                                      </tr>

                                      <!-- Arbeitspakete für Aufgaben der Ebene 3 -->
                                      
                                        <% @arbeitspakets.each do |arbeitspaket| %>
                                          <% if aufgabe.id == arbeitspaket.aufgabeid %>     
                                              <tr class="error"> 
                                                < <td><i class="icon-arrow-right" > <%= arbeitspaket.arbeitspaketname %> </td> 
                                                 </tr>                      
                                          <% end %>
                                        <% end %>
                                      <% end %>
                                <% end %>
                            <% end %>
                         <% end %>
                      <%end%>
                  <% end %>
              <%end%>
            <%end%>
      <% end %>
 
 </tbody> 
 </tr>
</table>
</div>




<div class="well sidebar-nav">

<table class="table table-bordered">
<thead>
          <tr>
            <th>01.01.2014 </th>
            <th>02.01.2014 </th>
            <th>03.01.2014 </th>
            <th>04.01.2014 </th>
            <th>05.01.2014 </th>
            <th>06.01.2014 </th>


          </tr>
 </thead>

 <tbody> 
<tr>

 <% if @projekt.projektleiter == current_user.email %> 

    
            <% @aufgaben.each do |aufgabe| %>
              <% if  @projekt.id == aufgabe.projektsid && aufgabe.aufgabenvorgaenger ==nil %>
                <% @vorgaenger1 = aufgabe.id %>
                <% @nachfolger1 = Aufgaben.find(:all, :conditions => [ "aufgabenvorgaenger = ?", aufgabe.id]) %>
              
                  <% if !@nachfolger1.present? %> <!-- Keine Aufgabe als Nachfolger vorhanden (APs anzeigen)-->
                      <!-- Arbeitspakete für Aufgaben der Ebene 1 -->
                   
                      <% @arbeitspakets.each do |arbeitspaket| %>
                        <% if aufgabe.id == arbeitspaket.aufgabeid %>
                           
                            
                                <tr>      
                              <td ><%= arbeitspaket.arbeitspaketname %> 
                                        <div class="progress">
                                                <div class="bar bar-success" role="progressbar" aria-valuenow="50" aria-valuemin="20" aria-valuemax="100" style="width: 100%">
                                                  <span class="sr-only"><%= arbeitspaket.arbeitspaketname %></span>
                                                </div>
                                              </div>             
                        <% end %>
                      <% end %>
                      </td> 
                 </tr>
                  <% else %> <!-- Aufgabe als Nachfolger vorhanden -->
                    <!-- Ebene 2 -->
                    
                      <% @aufgaben.each do |aufgabe| %>
                        <% if  @projekt.id == aufgabe.projektsid && aufgabe.aufgabenvorgaenger ==@vorgaenger1 %>
                          <% @vorgaenger2 = aufgabe.id %>
                          <% @nachfolger2 = Aufgaben.find(:all, :conditions => [ "aufgabenvorgaenger = ?", aufgabe.id]) %>
                       
                            <% if !@nachfolger2.present? %> <!-- Keine Aufgabe als Nachfolger vorhanden (APs anzeigen)-->
                            <!-- Arbeitspakete für Aufgaben der Ebene 2 -->
                              
                                
                      <% @arbeitspakets.each do |arbeitspaket| %>
                        <% if aufgabe.id == arbeitspaket.aufgabeid %>
                           
                            
                               <tr> 
                               <td> </td>      
                              <td <%= arbeitspaket.arbeitspaketname %> 
                                        <div class="progress">
                                                <div class="bar bar-progress" role="progressbar" aria-valuenow="50" aria-valuemin="20" aria-valuemax="100" style="width: 100%">
                                                  <span class="sr-only"><%= arbeitspaket.arbeitspaketname %></span>
                                                </div>
                                              </div>             
                        <% end %>
                      <% end %>
                      </td> 
                 </tr>
                            <% else %> <!-- Aufgabe als Nachfolger vorhanden -->

                              <!-- Ebene 3 -->
                              
                                <% @aufgaben.each do |aufgabe| %>
                                  <% if  @projekt.id == aufgabe.projektsid && aufgabe.aufgabenvorgaenger ==@vorgaenger2%>
                                    <% @vorgaenger3 = aufgabe.id %>
                                    <% @nachfolger3 = Aufgaben.find(:all, :conditions => [ "aufgabenvorgaenger = ?", aufgabe.id]) %>

                                      <!-- Arbeitspakete für Aufgaben der Ebene 3 -->
                                      
                                       
                      <% @arbeitspakets.each do |arbeitspaket| %>
                        <% if aufgabe.id == arbeitspaket.aufgabeid %>
                           
                             <tr>
                                   
                              <td <%= arbeitspaket.arbeitspaketname %> 
                                        <div class="progress">
                                                <div class="bar bar-success" role="progressbar" aria-valuenow="50" aria-valuemin="20" aria-valuemax="100" style="width: 100%">
                                                  <span class="sr-only"><%= arbeitspaket.arbeitspaketname %></span> 
                                                </div>
                                              </div>             
                        <% end %>
                      <% end %>
                      </td> 
                 </tr>
                                      <% end %>
                                <% end %>
                            <% end %>
                         <% end %>
                      <%end%>
                  <% end %>
              <%end%>
            <%end%>
      <% end %>


</  div>





<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

        <script src="./js/bootstrap.js"></script>
        <script type="text/javascript">
            $(document).on('page:load',(function( {
                $('.dropdown-toggle').dropdown();
                var frameheight = window.innerHeight - 50;
                document.getElementById("frame").style.height = frameheight + "px";
            });

            $(window).resize(function () {
                var frameheight = window.innerHeight - 50;
                document.getElementById("frame").style.height = frameheight + "px";
            });
            $(document).ready(function)
$(window).bind('page:change', function)
        </script>